<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Convertisseur</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="img/favicon.ico">
</head>
<body>
  <div id="header"></div>
  <div class="section" id="convertisseur">
    <h2>Convertisseur</h2>
    <table id="convertTable"><tr><th>Objet</th><th>Valeur (PM)</th><th>Quantité</th><th>Résultat</th></tr></table>
    <button onclick="addConvertRow()">➕ Ajouter une ligne</button>
  </div>
  <script src="data.js"></script>
  <script src="site.js"></script>
  <script src="header.js"></script>
  <script>
    function addConvertRow() {
      const table = document.getElementById("convertTable");
      const row = table.insertRow(-1);
      const options = Object.entries(monnaies.pieces).concat(Object.entries(monnaies.gemmes))
        .map(([k]) => `<option value="${k}">${k}</option>`).join('');
      row.innerHTML = `
        <td><select onchange="updateConvert(this)">${options}</select></td>
        <td class="valeur">0</td>
        <td><input type='number' value='0' oninput='updateConvert(this)'></td>
        <td class="resultat">0</td>
      `;
    }
    function updateConvert(el) {
      const row = el.closest("tr");
      const select = row.querySelector("select");
      const obj = select.value;
      const valeur = monnaies.pieces[obj] || monnaies.gemmes[obj] || 0;
      const qte = parseFloat(row.querySelector("input").value || 0);
      row.querySelector(".valeur").textContent = valeur;
      row.querySelector(".resultat").textContent = (valeur * qte).toFixed(2);
    }
  </script>
</body>
</html>
