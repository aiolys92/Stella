<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Inventaire Guilde</title>
  <meta name="description" content="Inventaire commun de la guilde - Gestion du trÃ©sor collectif">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="content fade-in">
    <!-- En-tÃªte de la page -->
    <header class="page-header">
      <h1>âš”ï¸ INVENTAIRE GUILDE âš”ï¸</h1>
      <p class="page-subtitle">TrÃ©sor commun de la confrÃ©rie</p>
    </header>

    <!-- ContrÃ´les principaux -->
    <section class="section">
      <div class="controls-header">
        <div class="controls-left">
          <h2>ğŸ’° Gestion du TrÃ©sor Commun</h2>
        </div>
        <div class="controls-right">
          <input type="file" accept=".json" id="fileInputInventory" style="display: none;">
          <button onclick="document.getElementById('fileInputInventory').click()" class="btn-action btn-load">
            ğŸ“‚ Importer
          </button>
          <button id="saveInventoryBtn" class="btn-action btn-save">
            ğŸ’¾ Sauvegarder
          </button>
        </div>
      </div>
      
      <!-- Affichage du total -->
      <div class="total-display">
        <span class="total-label">Valeur Totale Guilde:</span>
        <span id="totalPieces" class="total-value">0</span>
        <span class="total-unit">PM</span>
      </div>
    </section>

    <!-- Onglets des inventaires -->
    <section class="section">
      <div class="tabs-container">
        <div class="tabs-header">
          <button class="tab-button active" onclick="switchInventoryTab('pieces')" title="Monnaies mÃ©talliques de la guilde">
            ğŸª™ Monnaies
          </button>
          <button class="tab-button" onclick="switchInventoryTab('gemmes')" title="Gemmes prÃ©cieuses de la guilde">
            ğŸ’ Gemmes
          </button>
          <button class="tab-button" onclick="switchInventoryTab('distribution')" title="Distribution entre les membres">
            ğŸ“Š Distribution
          </button>
        </div>

        <!-- Inventaire des PiÃ¨ces -->
        <div id="tab-pieces" class="tab-content active">
          <div class="tab-header">
            <h2>ğŸª™ Monnaies MÃ©talliques de la Guilde</h2>
            <div class="tab-actions">
              <button onclick="addInventaireRow('pieces')" class="btn-action btn-add">
                â• Ajouter une monnaie
              </button>
              <button onclick="transferFromPersonal('pieces')" class="btn-action btn-transfer">
                ğŸ“¤ Transfer depuis personnel
              </button>
              <button onclick="distributeToMembers('pieces')" class="btn-action btn-load">
                ğŸ“Š Distribuer aux Membres
              </button>
            </div>
          </div>
          
          <div class="table-container">
            <table id="inventaireTablePieces" class="inventory-table">
              <thead>
                <tr>
                  <th width="25%">Nom</th>
                  <th width="15%">QuantitÃ©</th>
                  <th width="15%">Valeur Unitaire</th>
                  <th width="15%">Valeur Totale</th>
                  <th width="15%">Contribution</th>
                  <th width="15%">Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Lignes gÃ©nÃ©rÃ©es dynamiquement -->
              </tbody>
            </table>
            
            <!-- Section de distribution pour les piÃ¨ces -->
            <div id="distributionPieces" class="distribution-section" style="display: none;">
              <h3>ğŸ“Š Distribution des Monnaies</h3>
              <div class="distribution-results">
                <div class="currency-distribution-grid" id="distributionGridPieces">
                  <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Inventaire des Gemmes -->
        <div id="tab-gemmes" class="tab-content">
          <div class="tab-header">
            <h2>ğŸ’ Gemmes PrÃ©cieuses de la Guilde</h2>
            <div class="tab-actions">
              <button onclick="addInventaireRow('gemmes')" class="btn-action btn-add">
                â• Ajouter une gemme
              </button>
              <button onclick="transferFromPersonal('gemmes')" class="btn-action btn-transfer">
                ğŸ“¤ Transfer depuis personnel
              </button>
              <button onclick="distributeToMembers('gemmes')" class="btn-action btn-load">
                ğŸ“Š Distribuer aux Membres
              </button>
            </div>
          </div>
          
          <div class="table-container">
            <table id="inventaireTableGemmes" class="inventory-table">
              <thead>
                <tr>
                  <th width="25%">Nom</th>
                  <th width="15%">QuantitÃ©</th>
                  <th width="15%">Valeur Unitaire</th>
                  <th width="15%">Valeur Totale</th>
                  <th width="15%">Contribution</th>
                  <th width="15%">Actions</th>
                </tr>
              </thead>
              <tbody>
                <!-- Lignes gÃ©nÃ©rÃ©es dynamiquement -->
              </tbody>
            </table>
            
            <!-- Section de distribution pour les gemmes -->
            <div id="distributionGemmes" class="distribution-section" style="display: none;">
              <h3>ğŸ“Š Distribution des Gemmes</h3>
              <div class="distribution-results">
                <div class="currency-distribution-grid" id="distributionGridGemmes">
                  <!-- GÃ©nÃ©rÃ© dynamiquement -->
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Onglet Distribution -->
        <div id="tab-distribution" class="tab-content">
          <div class="tab-header">
            <h2>ğŸ“Š Distribution du TrÃ©sor</h2>
            <div class="tab-actions">
              <button onclick="openContributionModal()" class="btn-action btn-add">
                ğŸ“ Gestion des Membres
              </button>
            </div>
          </div>
          
          <!-- Configuration de la distribution -->
          <div class="distribution-config">
            <h3>âš™ï¸ Configuration des Membres</h3>
            <div class="config-form">
              <div class="input-group">
                <label for="memberCount">Nombre de Membres:</label>
                <input type="number" id="memberCount" value="4" min="1" max="20" onchange="updateAllDistributions()">
              </div>
              <div class="members-preview">
                <h4>Membres Actuels:</h4>
                <div id="membersPreview">
                  <!-- Liste des membres -->
                </div>
              </div>
            </div>
          </div>

          <!-- RÃ©sultats de distribution gÃ©nÃ©rale -->
          <div class="distribution-results">
            <h3>ğŸ“ˆ Distribution Totale du TrÃ©sor</h3>
            
            <!-- Distribution par type de monnaie -->
            <div class="currency-breakdown">
              <h4>ğŸª™ Distribution des Monnaies</h4>
              <div class="currency-distribution-grid" id="distributionMonnaies">
                <!-- GÃ©nÃ©rÃ© dynamiquement -->
              </div>
            </div>

            <!-- Distribution des gemmes -->
            <div class="currency-breakdown">
              <h4>ğŸ’ Distribution des Gemmes</h4>
              <div class="currency-distribution-grid" id="distributionGemmesList">
                <!-- GÃ©nÃ©rÃ© dynamiquement -->
              </div>
            </div>

            <!-- RÃ©sumÃ© total -->
            <div class="total-summary">
              <h4>ğŸ“Š RÃ©sumÃ© de la Distribution</h4>
              <div class="summary-grid" id="distributionSummary">
                <!-- GÃ©nÃ©rÃ© dynamiquement -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Liste des objets par catÃ©gories - CONSULTATION SEULEMENT -->
    <section class="section">
      <h2>ğŸ“‹ Liste de Toutes les Monnaies et Gemmes</h2>
      <p class="section-subtitle"><em>Consultation seulement - Aucune action de suppression</em></p>
      
      <!-- Filtres et recherche -->
      <div class="filters-row">
        <div class="filter-group">
          <label for="categoryFilter">CatÃ©gorie:</label>
          <select id="categoryFilter" onchange="filtrerParCategorie(this.value)">
            <option value="">Toutes les catÃ©gories</option>
            <option value="pieces">Monnaies</option>
            <option value="gemmes">Gemmes</option>
          </select>
        </div>
        
        <div class="search-group">
          <label for="searchObjects">Rechercher:</label>
          <input type="text" id="searchObjects" placeholder="Nom de l'objet..." 
                 oninput="rechercherObjets(this.value)">
        </div>
      </div>
      
      <!-- Conteneur des catÃ©gories - LECTURE SEULE -->
      <div class="categories-container" id="categoriesContainer">
        <div class="category-section">
          <h3>ğŸª™ Monnaies MÃ©talliques</h3>
          <div class="table-container">
            <table class="inventory-table">
              <thead>
                <tr>
                  <th width="60%">Nom</th>
                  <th width="40%">Valeur (PM)</th>
                </tr>
              </thead>
              <tbody id="listMonetae">
                <!-- GÃ©nÃ©rÃ© par JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
        
        <div class="category-section">
          <h3>ğŸ’ Gemmes PrÃ©cieuses</h3>
          <div class="table-container">
            <table class="inventory-table">
              <thead>
                <tr>
                  <th width="60%">Nom</th>
                  <th width="40%">Valeur (PM)</th>
                </tr>
              </thead>
              <tbody id="listGemmae">
                <!-- GÃ©nÃ©rÃ© par JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Informations sur le trÃ©sor de guilde -->
    <section class="section">
      <h2>ğŸ“Š Statistiques du TrÃ©sor de Guilde</h2>
      <div class="info-grid">
        <div class="info-card">
          <h3>ğŸª™ Ã‰tat des Monnaies</h3>
          <div id="statsMonetae">
            <p>Types disponibles: <span id="countMonetae">-</span></p>
            <p>Valeur moyenne: <span id="avgMonetae">-</span> PM</p>
            <p>Valeur maximale: <span id="maxMonetae">-</span> PM</p>
            <p>Pourcentage du total: <span id="percentMonetae">0%</span></p>
          </div>
        </div>
        
        <div class="info-card">
          <h3>ğŸ’ Ã‰tat des Gemmes</h3>
          <div id="statsGemmae">
            <p>Types disponibles: <span id="countGemmae">-</span></p>
            <p>Valeur moyenne: <span id="avgGemmae">-</span> PM</p>
            <p>Valeur maximale: <span id="maxGemmae">-</span> PM</p>
            <p>Pourcentage du total: <span id="percentGemmae">0%</span></p>
          </div>
        </div>
        
        <div class="info-card">
          <h3>âš–ï¸ Total du TrÃ©sor</h3>
          <div id="statsTotal">
            <p>Objets totaux: <span id="countTotal">0</span></p>
            <p>Valeur totale: <span id="valueTotal">0</span> PM</p>
            <p>Ã‰tat de la guilde: <span id="statusTotal">Vide</span></p>
            <p>Par membre: <span id="perMember">0</span> PM</p>
          </div>
        </div>
        
        <div class="info-card">
          <h3>ğŸ“ˆ Gestion de Guilde</h3>
          <div id="statsGuild">
            <p>Membres actifs: <span id="activeMembers">4</span></p>
            <p>DerniÃ¨re contribution: <span id="lastContribution">Jamais</span></p>
            <p>Croissance: <span id="growth">+0%</span> (mois)</p>
            <p>StabilitÃ©: <span id="stability">Stable</span></p>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal pour les contributions -->
    <div id="contributionModal" class="popin-overlay" onclick="closeContributionModal()">
      <div class="popin-content" onclick="event.stopPropagation()">
        <div class="popin-header">
          <h2>ğŸ“ Gestion des Membres</h2>
          <button onclick="closeContributionModal()" class="popin-close">âœ•</button>
        </div>
        
        <div class="popin-form">
          <h3>Membres de la Guilde</h3>
          <div id="membersList">
            <!-- GÃ©nÃ©rÃ© dynamiquement -->
          </div>
          
          <div class="form-field">
            <button onclick="addNewMember()" class="btn-action btn-add">
              â• Ajouter un Membre
            </button>
            <button onclick="saveContributions()" class="btn-action btn-save">
              ğŸ’¾ Sauvegarder les Membres
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="data.js"></script>
  <script src="script.js"></script>
  <script src="nav.js"></script>
  <script>
    // Variables globales pour la page Guilde
    let currentInventoryTab = 'pieces';
    let guildMembers = [
      { name: 'Dorusis', contribution: 25, class: 'Guerrier' },
      { name: 'Mage Aurelius', contribution: 30, class: 'Mage' },
      { name: 'Voleur Shadow', contribution: 20, class: 'Voleur' },
      { name: 'PrÃªtre Benedictus', contribution: 25, class: 'PrÃªtre' }
    ];

    // ===== GESTION DES ONGLETS D'INVENTAIRE =====
    function switchInventoryTab(tabName) {
      // DÃ©sactiver tous les onglets
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

      // Activer l'onglet sÃ©lectionnÃ©
      const tabButton = document.querySelector(`[onclick="switchInventoryTab('${tabName}')"]`);
      const tabContent = document.getElementById(`tab-${tabName}`);
      
      if (tabButton && tabContent) {
        tabButton.classList.add('active');
        tabContent.classList.add('active');
        currentInventoryTab = tabName;
        
        if (tabName === 'distribution') {
          updateAllDistributions();
          updateMembersPreview();
        }
      }
    }

    // ===== DISTRIBUTION DANS LES ONGLETS MONNAIES/GEMMES =====
    function distributeToMembers(type) {
      const distributionSection = document.getElementById(`distribution${type.charAt(0).toUpperCase() + type.slice(1)}`);
      const grid = document.getElementById(`distributionGrid${type.charAt(0).toUpperCase() + type.slice(1)}`);
      
      if (distributionSection.style.display === 'none') {
        // Afficher la distribution
        distributionSection.style.display = 'block';
        calculateDistributionForType(type);
        showNotification(`ğŸ“Š Distribution des ${type} calculÃ©e`);
      } else {
        // Masquer la distribution
        distributionSection.style.display = 'none';
      }
    }

    function calculateDistributionForType(type) {
      const grid = document.getElementById(`distributionGrid${type.charAt(0).toUpperCase() + type.slice(1)}`);
      const tableId = type === 'pieces' ? 'inventaireTablePieces' : 'inventaireTableGemmes';
      
      // RÃ©cupÃ©rer les donnÃ©es du trÃ©sor pour ce type
      const treasureData = gatherTreasureData(type);
      
      if (treasureData.length === 0) {
        grid.innerHTML = '<p class="no-results">Aucun trÃ©sor Ã  distribuer</p>';
        return;
      }
      
      // CrÃ©er les cartes de distribution par monnaie/gemme
      grid.innerHTML = '';
      
      treasureData.forEach(item => {
        const card = document.createElement('div');
        card.className = 'currency-card';
        
        // Calculer la distribution par membre pour cet item
        const sharePerMember = Math.floor(item.quantity / guildMembers.length);
        const remainder = item.quantity % guildMembers.length;
        
        let distributionHTML = `
          <div class="currency-header">
            <h4>${item.name}</h4>
            <div class="currency-total">${item.quantity} disponible(s)</div>
          </div>
          <div class="member-shares">
        `;
        
        guildMembers.forEach((member, index) => {
          const memberShare = sharePerMember + (index < remainder ? 1 : 0);
          distributionHTML += `
            <div class="member-share">
              <span class="member-name">${member.name}:</span>
              <span class="share-amount">${memberShare}</span>
            </div>
          `;
        });
        
        distributionHTML += '</div>';
        card.innerHTML = distributionHTML;
        grid.appendChild(card);
      });
    }

    // ===== DISTRIBUTION GÃ‰NÃ‰RALE =====
    function updateAllDistributions() {
      updateGlobalDistribution();
      
      // Mettre Ã  jour les distributions dans les onglets monnaies/gemmes si elles sont visibles
      if (document.getElementById('distributionPieces').style.display !== 'none') {
        calculateDistributionForType('pieces');
      }
      if (document.getElementById('distributionGemmes').style.display !== 'none') {
        calculateDistributionForType('gemmes');
      }
    }

    function updateGlobalDistribution() {
      // Distribution des monnaies
      const monnaiesData = gatherTreasureData('pieces');
      const monnaiesGrid = document.getElementById('distributionMonnaies');
      generateDistributionGrid(monnaiesGrid, monnaiesData);
      
      // Distribution des gemmes
      const gemmesData = gatherTreasureData('gemmes');
      const gemmesGrid = document.getElementById('distributionGemmesList');
      generateDistributionGrid(gemmesGrid, gemmesData);
      
      // RÃ©sumÃ© gÃ©nÃ©ral
      updateDistributionSummary(monnaiesData, gemmesData);
    }

    function generateDistributionGrid(container, treasureData) {
      if (treasureData.length === 0) {
        container.innerHTML = '<p class="no-results">Aucun Ã©lÃ©ment Ã  distribuer</p>';
        return;
      }
      
      container.innerHTML = '';
      
      treasureData.forEach(item => {
        const card = document.createElement('div');
        card.className = 'currency-card';
        
        // Calculer la distribution par membre
        const sharePerMember = Math.floor(item.quantity / guildMembers.length);
        const remainder = item.quantity % guildMembers.length;
        
        let distributionHTML = `
          <div class="currency-header">
            <h4>${item.name}</h4>
            <div class="currency-total">${item.quantity} total</div>
          </div>
          <div class="member-shares">
        `;
        
        guildMembers.forEach((member, index) => {
          const memberShare = sharePerMember + (index < remainder ? 1 : 0);
          distributionHTML += `
            <div class="member-share">
              <span class="member-name">${member.name}:</span>
              <span class="share-amount">${memberShare}</span>
            </div>
          `;
        });
        
        distributionHTML += '</div>';
        card.innerHTML = distributionHTML;
        container.appendChild(card);
      });
    }

    function updateDistributionSummary(monnaiesData, gemmesData) {
      const summaryGrid = document.getElementById('distributionSummary');
      summaryGrid.innerHTML = '';
      
      guildMembers.forEach(member => {
        const card = document.createElement('div');
        card.className = 'summary-card';
        
        let summaryHTML = `
          <h4>${member.name}</h4>
          <div class="member-summary">
        `;
        
        // RÃ©sumÃ© des monnaies
        if (monnaiesData.length > 0) {
          summaryHTML += '<div class="currency-group"><h5>ğŸª™ Monnaies:</h5>';
          monnaiesData.forEach(item => {
            const sharePerMember = Math.floor(item.quantity / guildMembers.length);
            const remainder = item.quantity % guildMembers.length;
            const memberIndex = guildMembers.indexOf(member);
            const memberShare = sharePerMember + (memberIndex < remainder ? 1 : 0);
            if (memberShare > 0) {
              summaryHTML += `<div class="summary-item">${item.name}: ${memberShare}</div>`;
            }
          });
          summaryHTML += '</div>';
        }
        
        // RÃ©sumÃ© des gemmes
        if (gemmesData.length > 0) {
          summaryHTML += '<div class="currency-group"><h5>ğŸ’ Gemmes:</h5>';
          gemmesData.forEach(item => {
            const sharePerMember = Math.floor(item.quantity / guildMembers.length);
            const remainder = item.quantity % guildMembers.length;
            const memberIndex = guildMembers.indexOf(member);
            const memberShare = sharePerMember + (memberIndex < remainder ? 1 : 0);
            if (memberShare > 0) {
              summaryHTML += `<div class="summary-item">${item.name}: ${memberShare}</div>`;
            }
          });
          summaryHTML += '</div>';
        }
        
        summaryHTML += '</div>';
        card.innerHTML = summaryHTML;
        summaryGrid.appendChild(card);
      });
    }

    function gatherTreasureData(type) {
      const tableId = type === 'pieces' ? 'inventaireTablePieces' : 'inventaireTableGemmes';
      const treasureData = [];
      
      const rows = document.querySelectorAll(`#${tableId} tbody tr`);
      rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 2) {
          const name = cells[0].textContent.trim();
          const quantity = parseInt(cells[1].textContent) || 0;
          
          if (quantity > 0) {
            treasureData.push({ name, quantity });
          }
        }
      });
      
      return treasureData;
    }

    function updateMembersPreview() {
      const preview = document.getElementById('membersPreview');
      preview.innerHTML = guildMembers.map(member => 
        `<span class="member-tag">${member.name} (${member.class})</span>`
      ).join('');
    }

    // ===== GESTION DES FILTRES POUR LA LISTE =====
    function filtrerParCategorie(categorie) {
      const sections = document.querySelectorAll('.category-section');
      sections.forEach(section => {
        if (categorie === '') {
          section.style.display = 'block';
        } else {
          const isRelevant = (categorie === 'pieces' && section.querySelector('#listMonetae')) ||
                           (categorie === 'gemmes' && section.querySelector('#listGemmae'));
          section.style.display = isRelevant ? 'block' : 'none';
        }
      });
    }

    function rechercherObjets(query) {
      if (!query.trim()) {
        document.querySelectorAll('#listMonetae tr, #listGemmae tr').forEach(row => {
          row.style.display = '';
        });
        return;
      }

      const queryLower = query.toLowerCase();
      
      document.querySelectorAll('#listMonetae tr, #listGemmae tr').forEach(row => {
        const name = row.cells[0].textContent.toLowerCase();
        row.style.display = name.includes(queryLower) ? '' : 'none';
      });
    }

    // ===== FONCTIONS DE TRANSFERT =====
    function transferFromPersonal(type) {
      showNotification(`ğŸ“¤ Fonction de transfert depuis l'inventaire personnel vers la guilde (${type})`);
      // Ã€ implÃ©menter : transfert depuis l'inventaire de Dorusis vers la guilde
    }

    // ===== GESTION DES CONTRIBUTIONS =====
    function openContributionModal() {
      document.getElementById('contributionModal').classList.add('active');
      populateMembersList();
    }

    function closeContributionModal() {
      document.getElementById('contributionModal').classList.remove('active');
    }

    function populateMembersList() {
      const membersList = document.getElementById('membersList');
      membersList.innerHTML = '';
      
      guildMembers.forEach((member, index) => {
        const memberDiv = document.createElement('div');
        memberDiv.className = 'member-contribution';
        memberDiv.innerHTML = `
          <div class="member-info">
            <input type="text" value="${member.name}" onchange="updateMemberName(${index}, this.value)" placeholder="Nom du membre">
            <select onchange="updateMemberClass(${index}, this.value)">
              <option value="Guerrier" ${member.class === 'Guerrier' ? 'selected' : ''}>Guerrier</option>
              <option value="Mage" ${member.class === 'Mage' ? 'selected' : ''}>Mage</option>
              <option value="Voleur" ${member.class === 'Voleur' ? 'selected' : ''}>Voleur</option>
              <option value="PrÃªtre" ${member.class === 'PrÃªtre' ? 'selected' : ''}>PrÃªtre</option>
            </select>
            <button onclick="removeMember(${index})" class="btn-action btn-delete">ğŸ—‘ï¸</button>
          </div>
        `;
        membersList.appendChild(memberDiv);
      });
    }

    function addNewMember() {
      guildMembers.push({
        name: 'Nouveau Membre',
        contribution: 25,
        class: 'Guerrier'
      });
      populateMembersList();
      document.getElementById('memberCount').value = guildMembers.length;
      updateMembersPreview();
      updateAllDistributions();
    }

    function removeMember(index) {
      guildMembers.splice(index, 1);
      populateMembersList();
      document.getElementById('memberCount').value = guildMembers.length;
      updateMembersPreview();
      updateAllDistributions();
    }

    function updateMemberName(index, name) {
      guildMembers[index].name = name;
      updateMembersPreview();
      updateAllDistributions();
    }

    function updateMemberClass(index, classType) {
      guildMembers[index].class = classType;
      updateMembersPreview();
      updateAllDistributions();
    }

    function saveContributions() {
      closeContributionModal();
      updateAllDistributions();
      updateMembersPreview();
      showNotification('ğŸ’¾ Membres sauvegardÃ©s');
    }

    // ===== POPULATION DE LA LISTE DES OBJETS =====
    function populateObjectsList() {
      // Peupler la liste des monnaies
      const listMonetae = document.getElementById('listMonetae');
      if (listMonetae && window.monnaies) {
        listMonetae.innerHTML = '';
        Object.entries(window.monnaies.pieces)
          .sort(([,a], [,b]) => b - a)
          .forEach(([nom, valeur]) => {
            const row = listMonetae.insertRow();
            row.innerHTML = `
              <td><strong>${nom}</strong></td>
              <td>${valeur.toFixed(4)}</td>
            `;
          });
      }

      const listGemmae = document.getElementById('listGemmae');
      if (listGemmae && window.monnaies) {
        listGemmae.innerHTML = '';
        Object.entries(window.monnaies.gemmes)
          .sort(([,a], [,b]) => b - a)
          .forEach(([nom, valeur]) => {
            const row = listGemmae.insertRow();
            row.innerHTML = `
              <td><strong>${nom}</strong></td>
              <td>${valeur.toFixed(2)}</td>
            `;
          });
      }
    }

    // =====
